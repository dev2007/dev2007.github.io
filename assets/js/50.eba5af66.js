(window.webpackJsonp=window.webpackJsonp||[]).push([[50],{422:function(_,t,e){"use strict";e.r(t);var v=e(1),s=Object(v.a)({},(function(){var _=this,t=_._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":_.$parent.slotKey}},[t("p",[_._v("在 Elasticsearch 中，索引可被认作一种文档的优化集合，且每个文档都是字段的集合，字段是包含你数据的键值对。")]),_._v(" "),t("p",[_._v("也就是：索引 → 文档 → 字段 → 数据。")]),_._v(" "),t("p",[_._v("一个 Elasticsearch 索引只是一个或多个物理分片的逻辑组，其中每个分片实际上是一个独立索引。通过将索引中的文档分布在多个分片上，并将这些分片分布在多个节点上。")]),_._v(" "),t("p",[_._v("也就是：节点 → 分片 → 文档（索引）。")]),_._v(" "),t("p",[_._v("分片分为主分片和副本，每个文档都属于一个主分片，然后副分片是主分片的复制。")]),_._v(" "),t("p",[_._v("核心概念类比：")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("概念")]),_._v(" "),t("th",[_._v("类比")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("索引(indices)")]),_._v(" "),t("td",[_._v("数据库（Database）")])]),_._v(" "),t("tr",[t("td",[_._v("类型(type)")]),_._v(" "),t("td",[_._v("表(Table)")])]),_._v(" "),t("tr",[t("td",[_._v("文档(document)")]),_._v(" "),t("td",[_._v("行(Row )")])]),_._v(" "),t("tr",[t("td",[_._v("字段(field)")]),_._v(" "),t("td",[_._v("列(Columns)")])])])]),_._v(" "),t("blockquote",[t("p",[_._v("6.0.0开始，单个索引只能有一个类型，7.0.0开始不建议使用。8.0.0后完全不支持。")])]),_._v(" "),t("h2",{attrs:{id:"索引设置"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#索引设置"}},[_._v("#")]),_._v(" 索引设置")]),_._v(" "),t("p",[_._v("索引设置分为：")]),_._v(" "),t("ul",[t("li",[_._v("静态索引设置：创建时设置，或索引关闭后可修改的。")]),_._v(" "),t("li",[_._v("动态索引设置：直接用更新索引 API 就可以修改。")])]),_._v(" "),t("p",[_._v("相关设置参数见下表：")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("分类")]),_._v(" "),t("th",[_._v("参数")]),_._v(" "),t("th",[_._v("说明")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[_._v("静态索引设置（Static index settings）")]),_._v(" "),t("td"),_._v(" "),t("td")]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td",[_._v("number_of_shards")]),_._v(" "),t("td",[_._v("索引的主分片数，默认为"),t("code",[_._v("1")]),_._v("，上限为"),t("code",[_._v("1024")]),_._v("。只能索引"),t("strong",[_._v("创建时设置")]),_._v("。")])]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td",[_._v("number_of_routing_shards")]),_._v(" "),t("td",[_._v("用于拆分 （"),t("code",[_._v("split")]),_._v("）索引路由分片数")])]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td",[_._v("shard.check_on_startup")]),_._v(" "),t("td",[_._v("打开前对分片进行检测，损坏会中断打开，默认值为"),t("code",[_._v("false")]),_._v("，值有： "),t("code",[_._v("true")]),_._v("、"),t("code",[_._v("checksum")]),_._v("、"),t("code",[_._v("false")])])]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td",[_._v("codec")]),_._v(" "),t("td",[_._v("默认使用LZ4压缩存储数据，可使用"),t("code",[_._v("best_compression")]),_._v("更高的压缩比，但降低存储字段性能。")])]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td",[_._v("routing_partition_size")]),_._v(" "),t("td",[_._v("自定义可转换的路由分片数。 默认值"),t("code",[_._v("1")]),_._v("，必须小于"),t("code",[_._v("number_of_shards")]),_._v("（除非它也是1），只能索引"),t("strong",[_._v("创建时设置")]),_._v("。")])]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td",[t("s",[_._v("soft_deletes.enabled")])]),_._v(" "),t("td",[_._v("索引软删除，默认"),t("code",[_._v("true")]),_._v("。支持版本：["),t("code",[_._v("6.5.0")]),_._v(","),t("code",[_._v("7.6.0")]),_._v(") ，低于集合的版本无此配置，大于集合的版本不推荐修改")])]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td",[_._v("soft_deletes.retention_lease.period")]),_._v(" "),t("td",[_._v("分片历史过期前的保留周期，默认"),t("code",[_._v("12h")])])]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td",[_._v("load_fixed_bitset_filters_eagerly")]),_._v(" "),t("td",[_._v("是否为嵌套查询预加载缓存筛选器，默认"),t("code",[_._v("true")]),_._v("，值有："),t("code",[_._v("true")]),_._v("、"),t("code",[_._v("false")])])]),_._v(" "),t("tr",[t("td",[_._v("动态索引设置（Dynamic index setting）")]),_._v(" "),t("td"),_._v(" "),t("td")]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td",[_._v("hidden")]),_._v(" "),t("td",[_._v("索引是否默认隐藏，如隐藏，需要在请求带参"),t("code",[_._v("expand_wildcards")]),_._v("才可查询。默认值为"),t("code",[_._v("false")]),_._v("，值有："),t("code",[_._v("true")]),_._v("、"),t("code",[_._v("false")])])]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td",[_._v("number_of_replicas")]),_._v(" "),t("td",[_._v("每个主分片的副本（备份数），默认值为"),t("code",[_._v("1")])])]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td",[_._v("auto_expand_replicas")]),_._v(" "),t("td",[_._v("基于集群中数据节点数量，自动扩展备份数，设置为以连接符分隔的下限和上限（如，"),t("code",[_._v("0-5")]),_._v("）或者使用 "),t("code",[_._v("all")]),_._v(" 作为上限（如，"),t("code",[_._v("0-all")]),_._v("）。默认为 "),t("code",[_._v("false")]),_._v("（即禁用）。")])]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td",[_._v("search.idle.after")]),_._v(" "),t("td",[_._v("搜索空闲前等待时间，默认值"),t("code",[_._v("30s")])])]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td",[_._v("refresh_interval")]),_._v(" "),t("td",[_._v("刷新操作周期，让索引最近变更可被搜索。默认值"),t("code",[_._v("1s")]),_._v("，可设置为"),t("code",[_._v("-1")]),_._v("表示禁用刷新")])]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td",[_._v("max_result_window")]),_._v(" "),t("td",[_._v("从索引搜索数据的最大值（即"),t("code",[_._v("from")]),_._v(" + "),t("code",[_._v("size")]),_._v("的值），默认值"),t("code",[_._v("10000")])])]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td",[_._v("max_inner_result_window")]),_._v(" "),t("td",[_._v("索引内部命中和最高命中聚集最大值（即"),t("code",[_._v("from")]),_._v(" + "),t("code",[_._v("size")]),_._v("的值），默认值"),t("code",[_._v("100")])])]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td",[_._v("max_rescore_window")]),_._v(" "),t("td",[_._v("搜索索引重打分（"),t("code",[_._v("rescore")]),_._v("）请求时的"),t("code",[_._v("window_size")]),_._v("最大值（默认与"),t("code",[_._v("max_result_window")]),_._v("一样默认"),t("code",[_._v("10000")]),_._v("）")])]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td",[_._v("max_docvalue_fields_search")]),_._v(" "),t("td",[_._v("允许查询"),t("code",[_._v("docvalue_fields")]),_._v("最大值，默认值"),t("code",[_._v("100")])])]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td",[_._v("max_script_fields")]),_._v(" "),t("td",[_._v("允许查询"),t("code",[_._v("script_fields")]),_._v("最大值，默认值"),t("code",[_._v("32")])])]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td",[_._v("max_ngram_diff")]),_._v(" "),t("td",[_._v("用于"),t("code",[_._v("NGramTokenizer")]),_._v("和"),t("code",[_._v("NGramTokenFilter")]),_._v("的，"),t("code",[_._v("min_gram")]),_._v("和"),t("code",[_._v("max_gram")]),_._v("之间的最大差值 ，默认值"),t("code",[_._v("1")])])]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td",[_._v("max_shingle_diff")]),_._v(" "),t("td",[_._v("用于"),t("code",[_._v("shingle token filter")]),_._v("的，"),t("code",[_._v("max_shingle_size")]),_._v("和"),t("code",[_._v("min_shingle_size")]),_._v("之间的最大差值，默认值"),t("code",[_._v("3")])])]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td",[_._v("max_refresh_listeners")]),_._v(" "),t("td",[_._v("每个索引分片上的最大刷新监听器数量。")])]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td",[_._v("analyze.max_token_count")]),_._v(" "),t("td",[_._v("用于_analyze API的最大标记值，默认值"),t("code",[_._v("10000")])])]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td",[_._v("highlight.max_analyzed_offset")]),_._v(" "),t("td",[_._v("用于高亮请求的可分析最大字符数量，仅对无"),t("code",[_._v("offsets")]),_._v("和"),t("code",[_._v("term vectors")]),_._v("的文本高亮请求有效。默认值"),t("code",[_._v("1000000")])])]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td",[_._v("max_terms_count")]),_._v(" "),t("td",[_._v("用于词语查询最大词语数量，默认值"),t("code",[_._v("65536")])])]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td",[_._v("max_regex_length")]),_._v(" "),t("td",[_._v("用于正则查询的最大正则长度，默认值"),t("code",[_._v("1000")])])]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td",[_._v("routing.allocation.enable")]),_._v(" "),t("td",[_._v("控制索引的分片分配。默认值"),t("code",[_._v("all")]),_._v("，值有："),t("code",[_._v("all")]),_._v("、"),t("code",[_._v("primaries")]),_._v("、"),t("code",[_._v("new_primaries")]),_._v("、"),t("code",[_._v("none")])])]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td",[_._v("routing.rebalance.enable")]),_._v(" "),t("td",[_._v("允许索引分片重平衡，默认值"),t("code",[_._v("all")]),_._v("，值有："),t("code",[_._v("all")]),_._v("、"),t("code",[_._v("primaries")]),_._v("、"),t("code",[_._v("replicas")]),_._v("、"),t("code",[_._v("none")])])]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td",[_._v("gc_deletes")]),_._v(" "),t("td",[_._v("已删除文档的版本号可用于进一步版本化操作的时长，默认值"),t("code",[_._v("60s")])])]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td",[_._v("default_pipeline")]),_._v(" "),t("td",[_._v("索引的默认摄取节点（ingest node）管道。可使用参数"),t("code",[_._v("pipeline")]),_._v("重载。特定参数"),t("code",[_._v("_none")]),_._v("表明不会运行摄取节点管道。")])]),_._v(" "),t("tr",[t("td"),_._v(" "),t("td",[_._v("final_pipeline")]),_._v(" "),t("td",[_._v("索引的最终摄取节点（ingest node）管道。特定参数"),t("code",[_._v("_none")]),_._v("表明不会运行摄取节点管道。")])])])]),_._v(" "),t("p",[_._v("这么多设置，一般使用都不会进行配置。可能常用的有： "),t("code",[_._v("index.number_of_shards")]),_._v("（主分片数）、"),t("code",[_._v("index.number_of_replicas")]),_._v("（主分片的副本数）。")]),_._v(" "),t("h2",{attrs:{id:"示例"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#示例"}},[_._v("#")]),_._v(" 示例")]),_._v(" "),t("p",[_._v("1.创建一个索引，带配置"),t("code",[_._v("number_of_shards")]),_._v(" 和 "),t("code",[_._v("number_of_replicas")]),_._v(" 。主分片设置为 3，主分片的副本设置为 2。路径当中为索引名称，后面的json为请求体内容，索引名称要符合以下规则：")]),_._v(" "),t("p",[_._v("索引名字必须符合以下约定：")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("只能是小写字符")])]),_._v(" "),t("li",[t("p",[_._v("不能包含字符："),t("code",[_._v("\\")]),_._v("、"),t("code",[_._v("/")]),_._v("、"),t("code",[_._v("*")]),_._v("、"),t("code",[_._v("?")]),_._v("、"),t("code",[_._v('"')]),_._v("、"),t("code",[_._v("<")]),_._v("、"),t("code",[_._v(">")]),_._v("、"),t("code",[_._v("|")]),_._v("、"),t("code"),_._v("(空格)、"),t("code",[_._v(",")]),_._v("、"),t("code",[_._v("#")])])]),_._v(" "),t("li",[t("p",[_._v("7.0 之前索引可以包含冒号（:），但在 7.0 之后不推荐。")])]),_._v(" "),t("li",[t("p",[_._v("不能以 "),t("code",[_._v("-")]),_._v("、"),t("code",[_._v("_")]),_._v("、"),t("code",[_._v("+")]),_._v(" 开头")])]),_._v(" "),t("li",[t("p",[_._v("不能是 "),t("code",[_._v(".")]),_._v(" 或 "),t("code",[_._v("..")])])]),_._v(" "),t("li",[t("p",[_._v("长度不能超过 255 字节（注意是字节，所以多字节字符会更快达到 255 的限制）")])]),_._v(" "),t("li",[t("p",[_._v("名字以 "),t("code",[_._v(".")]),_._v(" 开头不推荐，除非由插件管理的隐藏索引和内部索引")])])]),_._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[_._v("PUT /my-index-000001\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n\n "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"settings"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"index"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n\n   "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"number_of_shards"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[_._v("3")]),_._v(",\n\n   "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"number_of_replicas"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[_._v("2")]),_._v("\n\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n\n "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n")])])]),t("p",[_._v("进一步，不用显示指定 index 部分：")]),_._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[_._v("PUT /my-index-000001\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"settings"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"number_of_shards"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[_._v("3")]),_._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"number_of_replicas"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[_._v("2")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n")])])]),t("ol",{attrs:{start:"2"}},[t("li",[_._v("加上映射配置一起")])]),_._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[_._v("PUT /test\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"settings"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"number_of_shards"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token number"}},[_._v("1")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v(",\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"mappings"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"properties"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n      "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"field1"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"type"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"text"')]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n")])])]),t("ol",{attrs:{start:"3"}},[t("li",[_._v("配置索引别名")])]),_._v(" "),t("div",{staticClass:"language-bash extra-class"},[t("pre",{pre:!0,attrs:{class:"language-bash"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"aliases"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"alias_1"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v(",\n    "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"alias_2"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n      "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"filter"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n        "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"term"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"user.id"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"kimchy"')]),_._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n      "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v(",\n      "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"routing"')]),t("span",{pre:!0,attrs:{class:"token builtin class-name"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"shard-1"')]),_._v("\n    "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n")])])]),t("p",[_._v("响应示例：")]),_._v(" "),t("div",{staticClass:"language-json extra-class"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("{")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"acknowledged"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[_._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"shards_acknowledged"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token boolean"}},[_._v("true")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v(",")]),_._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[_._v('"index"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[_._v(":")]),_._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[_._v('"test"')]),_._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[_._v("}")]),_._v("\n")])])]),t("p",[t("code",[_._v("acknowledged")]),_._v(" 表明在集群中索引是否成功创建，同时 "),t("code",[_._v("shards_acknowledged")]),_._v(" 表明在超时之前，是否为每个分片启动了必需的分片副本数量。")]),_._v(" "),t("p",[_._v("需要注意的就是：两个值都可能是 "),t("code",[_._v("false")]),_._v("，但索引也是能创建成功的，这里只表明超时前的操作状态。")]),_._v(" "),t("h2",{attrs:{id:"索引管理-api"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#索引管理-api"}},[_._v("#")]),_._v(" 索引管理 API")]),_._v(" "),t("p",[_._v("进一步，与索引管理相关的API如下，涉及索引本身的 "),t("code",[_._v("CRUD")]),_._v(" 等操作：")]),_._v(" "),t("table",[t("thead",[t("tr",[t("th",[_._v("API文档")]),_._v(" "),t("th",[_._v("Http方法")]),_._v(" "),t("th",[_._v("URL")]),_._v(" "),t("th",[_._v("路径参数")]),_._v(" "),t("th",[_._v("查询参数")]),_._v(" "),t("th",[_._v("请求体")])])]),_._v(" "),t("tbody",[t("tr",[t("td",[t("a",{attrs:{href:"https://elasticsearch.bookhub.tech/#/rest_apis/index_apis/create_api",target:"_blank",rel:"noopener noreferrer"}},[_._v("创建索引"),t("OutboundLink")],1)]),_._v(" "),t("td",[t("strong",[_._v("PUT")])]),_._v(" "),t("td",[_._v("/{index}")]),_._v(" "),t("td",[t("code",[_._v("{index}")]),_._v(" 索引名字")]),_._v(" "),t("td",[t("code",[_._v("include_type_name")]),_._v(" "),t("br"),t("code",[_._v("wait_for_active_shards")]),t("br"),t("code",[_._v("master_timeout")]),t("br"),t("code",[_._v("timeout")])]),_._v(" "),t("td",[t("code",[_._v("aliases")]),_._v(" "),t("br"),t("code",[_._v("mappings")])])]),_._v(" "),t("tr",[t("td",[t("a",{attrs:{href:"https://elasticsearch.bookhub.tech/#/rest_apis/index_apis/delete_index",target:"_blank",rel:"noopener noreferrer"}},[_._v("删除索引"),t("OutboundLink")],1)]),_._v(" "),t("td",[t("strong",[_._v("DELETE")])]),_._v(" "),t("td",[_._v("/{index}")]),_._v(" "),t("td",[t("code",[_._v("{index}")]),_._v(" 索引名字")]),_._v(" "),t("td",[t("code",[_._v("allow_no_indices")]),t("br"),t("code",[_._v("expand_wildcards")]),t("br"),t("code",[_._v("ignore_unavailable")]),t("br"),t("code",[_._v("master_timeout")]),t("br"),t("code",[_._v("timeout")])]),_._v(" "),t("td",[_._v("无")])]),_._v(" "),t("tr",[t("td",[t("a",{attrs:{href:"https://elasticsearch.bookhub.tech/#/rest_apis/index_apis/get_index",target:"_blank",rel:"noopener noreferrer"}},[_._v("获取索引"),t("OutboundLink")],1)]),_._v(" "),t("td",[t("strong",[_._v("GET")])]),_._v(" "),t("td",[_._v("/{index}")]),_._v(" "),t("td",[t("code",[_._v("{index}")]),_._v("索引名字")]),_._v(" "),t("td",[t("code",[_._v("allow_no_indices")]),t("br"),t("code",[_._v("expand_wildcards")]),t("br"),t("code",[_._v("flat_settings")]),t("br"),t("code",[_._v("include_defaults")]),t("br"),t("code",[_._v("include_type_name")]),t("br"),t("code",[_._v("ignore_unavailable")]),t("br"),t("code",[_._v("local")]),t("br"),t("code",[_._v("master_timeout")]),t("br")]),_._v(" "),t("td",[_._v("无")])]),_._v(" "),t("tr",[t("td",[t("a",{attrs:{href:"https://elasticsearch.bookhub.tech/#/rest_apis/index_apis/index_exists",target:"_blank",rel:"noopener noreferrer"}},[_._v("索引存在"),t("OutboundLink")],1)]),_._v(" "),t("td",[t("strong",[_._v("HEAD")])]),_._v(" "),t("td",[_._v("/{index}")]),_._v(" "),t("td",[t("code",[_._v("{index}")]),_._v("索引名字，可多个名字用逗号分隔")]),_._v(" "),t("td",[t("code",[_._v("allow_no_indices")]),t("br"),t("code",[_._v("expand_wildcards")]),t("br"),t("code",[_._v("flat_settings")]),t("br"),t("code",[_._v("include_defaults")]),t("br"),t("code",[_._v("include_type_name")]),t("br"),t("code",[_._v("ignore_unavailable")]),t("br"),t("code",[_._v("local")]),t("br")]),_._v(" "),t("td",[_._v("无")])]),_._v(" "),t("tr",[t("td",[t("a",{attrs:{href:"https://elasticsearch.bookhub.tech/#/rest_apis/index_apis/close_index",target:"_blank",rel:"noopener noreferrer"}},[_._v("关闭索引"),t("OutboundLink")],1)]),_._v(" "),t("td",[t("strong",[_._v("POST")])]),_._v(" "),t("td",[_._v("/{index}/_close")]),_._v(" "),t("td",[t("code",[_._v("{index}")]),_._v("索引名字，可多个名字用逗号分隔")]),_._v(" "),t("td",[t("code",[_._v("allow_no_indices")]),t("br"),t("code",[_._v("expand_wildcards")]),t("br"),t("code",[_._v("ignore_unavailable")]),t("br"),t("code",[_._v("wait_for_active_shards")]),t("br"),t("code",[_._v("master_timeout")]),t("br"),t("code",[_._v("timeout")])]),_._v(" "),t("td",[_._v("无")])]),_._v(" "),t("tr",[t("td",[t("a",{attrs:{href:"https://elasticsearch.bookhub.tech/#/rest_apis/index_apis/open_index",target:"_blank",rel:"noopener noreferrer"}},[_._v("开启索引"),t("OutboundLink")],1)]),_._v(" "),t("td",[t("strong",[_._v("POST")])]),_._v(" "),t("td",[_._v("/{index}/_open")]),_._v(" "),t("td",[t("code",[_._v("{index}")]),_._v("索引名字，可多个名字用逗号分隔。也可使用 "),t("code",[_._v("_all")]),_._v(" 或 "),t("code",[_._v("*")]),_._v(" 代表所有")]),_._v(" "),t("td",[t("code",[_._v("allow_no_indices")]),t("br"),t("code",[_._v("expand_wildcards")]),t("br"),t("code",[_._v("ignore_unavailable")]),t("br"),t("code",[_._v("wait_for_active_shards")]),t("br"),t("code",[_._v("master_timeout")]),t("br"),t("code",[_._v("timeout")])]),_._v(" "),t("td",[_._v("无")])]),_._v(" "),t("tr",[t("td",[t("a",{attrs:{href:"https://elasticsearch.bookhub.tech/#/rest_apis/index_apis/shrink_index",target:"_blank",rel:"noopener noreferrer"}},[_._v("收缩索引"),t("OutboundLink")],1)]),_._v(" "),t("td",[t("strong",[_._v("POST")]),_._v(" 或 "),t("strong",[_._v("PUT")])]),_._v(" "),t("td",[_._v("/{index}/_shrink/{target_index}")]),_._v(" "),t("td",[t("code",[_._v("{index}")]),_._v(" 源索引名字"),t("br"),t("code",[_._v("{target_index}")]),_._v(" 目标索引名字")]),_._v(" "),t("td",[t("code",[_._v("wait_for_active_shards")]),t("br"),t("code",[_._v("master_timeout")]),t("br"),t("code",[_._v("timeout")])]),_._v(" "),t("td",[t("code",[_._v("aliases")]),t("br"),t("code",[_._v("settings")]),t("br"),t("code",[_._v("max_primary_shard_size")]),t("br")])]),_._v(" "),t("tr",[t("td",[t("a",{attrs:{href:"https://elasticsearch.bookhub.tech/#/rest_apis/index_apis/split_index",target:"_blank",rel:"noopener noreferrer"}},[_._v("拆分索引"),t("OutboundLink")],1)]),_._v(" "),t("td",[t("strong",[_._v("POST")]),_._v(" 或 "),t("strong",[_._v("PUT")])]),_._v(" "),t("td",[_._v("/{index}/_split/{target-index}")]),_._v(" "),t("td",[t("code",[_._v("{index}")]),_._v(" 源索引名字"),t("br"),t("code",[_._v("{target_index}")]),_._v(" 目标索引名字")]),_._v(" "),t("td",[t("code",[_._v("wait_for_active_shards")]),t("br"),t("code",[_._v("master_timeout")]),t("br"),t("code",[_._v("timeout")])]),_._v(" "),t("td",[t("code",[_._v("aliases")]),t("br"),t("code",[_._v("settings")])])]),_._v(" "),t("tr",[t("td",[t("a",{attrs:{href:"https://elasticsearch.bookhub.tech/#/rest_apis/index_apis/clone_index",target:"_blank",rel:"noopener noreferrer"}},[_._v("复制索引"),t("OutboundLink")],1)]),_._v(" "),t("td",[t("strong",[_._v("POST")]),_._v(" 或 "),t("strong",[_._v("PUT")])]),_._v(" "),t("td",[_._v("/{index}/_clone/{target-index}")]),_._v(" "),t("td",[t("code",[_._v("{index}")]),_._v(" 源索引名字"),t("br"),t("code",[_._v("{target_index}")]),_._v(" 目标索引名字")]),_._v(" "),t("td",[t("code",[_._v("wait_for_active_shards")]),t("br"),t("code",[_._v("master_timeout")]),t("br"),t("code",[_._v("timeout")])]),_._v(" "),t("td",[t("code",[_._v("aliases")]),t("br"),t("code",[_._v("settings")])])]),_._v(" "),t("tr",[t("td",[t("a",{attrs:{href:"https://elasticsearch.bookhub.tech/#/rest_apis/index_apis/rollover_index",target:"_blank",rel:"noopener noreferrer"}},[_._v("翻转索引"),t("OutboundLink")],1)]),_._v(" "),t("td",[t("strong",[_._v("POST")])]),_._v(" "),t("td",[_._v("/{rollover-target}/_rollover 或   /{rollover-target}/_rollover/{target-index}")]),_._v(" "),t("td",[t("code",[_._v("{rollover-target}")]),_._v(" 待翻转索引名字。"),t("code",[_._v("{target-index}")]),_._v(" 可选的目标索引名字")]),_._v(" "),t("td",[t("code",[_._v("dry_run")]),t("br"),t("code",[_._v("include_type_name")]),t("br"),t("code",[_._v("wait_for_active_shards")]),t("br"),t("code",[_._v("master_timeout")]),t("br"),t("code",[_._v("timeout")])]),_._v(" "),t("td",[t("code",[_._v("aliases")]),t("br"),t("code",[_._v("conditions")]),t("br"),t("code",[_._v("mappings")]),t("br"),t("code",[_._v("settings")])])]),_._v(" "),t("tr",[t("td",[t("a",{attrs:{href:"https://elasticsearch.bookhub.tech/#/rest_apis/index_apis/freeze_index",target:"_blank",rel:"noopener noreferrer"}},[_._v("冻结索引"),t("OutboundLink")],1)]),_._v(" "),t("td",[t("strong",[_._v("POST")])]),_._v(" "),t("td",[_._v("/{index}/_freeze")]),_._v(" "),t("td",[t("code",[_._v("{index}")]),_._v("索引名字")]),_._v(" "),t("td",[_._v("无")]),_._v(" "),t("td",[_._v("无")])]),_._v(" "),t("tr",[t("td",[t("a",{attrs:{href:"https://elasticsearch.bookhub.tech/#/rest_apis/index_apis/unfreeze_index",target:"_blank",rel:"noopener noreferrer"}},[_._v("解冻索引"),t("OutboundLink")],1)]),_._v(" "),t("td",[t("strong",[_._v("POST")])]),_._v(" "),t("td",[_._v("/{index}/_unfreeze")]),_._v(" "),t("td",[t("code",[_._v("{index}")]),_._v("索引名字")]),_._v(" "),t("td",[_._v("无")]),_._v(" "),t("td",[_._v("无")])]),_._v(" "),t("tr",[t("td",[t("a",{attrs:{href:"https://elasticsearch.bookhub.tech/#/rest_apis/index_apis/resolve_index",target:"_blank",rel:"noopener noreferrer"}},[_._v("解析索引"),t("OutboundLink")],1)]),_._v(" "),t("td",[t("strong",[_._v("GET")])]),_._v(" "),t("td",[_._v("/_resolve/index/{name}")]),_._v(" "),t("td",[t("code",[_._v("{name}")]),_._v("索引名字，可多个名字用逗号分隔")]),_._v(" "),t("td",[t("code",[_._v("expand_wildcards")]),t("br")]),_._v(" "),t("td",[_._v("无")])])])]),_._v(" "),t("p",[_._v("基于以上表中，我们可以再总结一下。")]),_._v(" "),t("p",[_._v("索引的 "),t("code",[_._v("CRUD")]),_._v(" 操作为：")]),_._v(" "),t("ul",[t("li",[_._v("增：创建索引 "),t("code",[_._v("PUT /{index}")])]),_._v(" "),t("li",[_._v("删：删除索引 "),t("code",[_._v("DELETE /{index}")])]),_._v(" "),t("li",[_._v("查：获取索引 "),t("code",[_._v("GET /{index}")])]),_._v(" "),t("li",[_._v("改：不涉及直接的 API，且只能修改索引的属性，而且需要看属性是静态属性还是动态属性等。")])]),_._v(" "),t("p",[_._v("索引存在性操作：")]),_._v(" "),t("ul",[t("li",[_._v("索引存在  "),t("code",[_._v("HEAD /{index}")])])]),_._v(" "),t("blockquote",[t("p",[_._v("elasticsearch 中有这个索引，就响应 "),t("code",[_._v("200")]),_._v("，没有这个索引，就响应 "),t("code",[_._v("404")]),_._v("。")])]),_._v(" "),t("p",[_._v("索引开、关操作：")]),_._v(" "),t("ul",[t("li",[_._v("关闭 "),t("code",[_._v("POST /{index}/_close")])]),_._v(" "),t("li",[_._v("开启 "),t("code",[_._v("POST /{index}/_open")])])]),_._v(" "),t("blockquote",[t("p",[_._v("关闭索引后，将不能读写。开关状态可以在 "),t("code",[_._v("GET /_cat/indices/customer?v")]),_._v(" 中查看，值为 "),t("code",[_._v("open")]),_._v(" 或 "),t("code",[_._v("close")])])]),_._v(" "),t("p",[_._v("索引冻结、解冻操作：")]),_._v(" "),t("ul",[t("li",[_._v("冻结 "),t("code",[_._v("POST /{index}/_freeze")])]),_._v(" "),t("li",[_._v("解冻 "),t("code",[_._v("POST /{index}/_unfreeze")])])]),_._v(" "),t("blockquote",[t("p",[_._v("冻结索引后，将不能写。冻结状态可以在 "),t("code",[_._v("GET /{index}")]),_._v(" 中查看，位于 "),t("code",[_._v("{index}")]),_._v("->"),t("code",[_._v("settings")]),_._v("->"),t("code",[_._v("index")]),_._v("->"),t("code",[_._v("frozen")]),_._v("，值为"),t("code",[_._v("false")]),_._v(" 或``true`。")])]),_._v(" "),t("p",[_._v("索引缩、扩操作：")]),_._v(" "),t("ul",[t("li",[_._v("收缩 "),t("code",[_._v("POST /{index}/_shrink/{target_index}")])]),_._v(" "),t("li",[_._v("拆分 "),t("code",[_._v("POST /{index}/_split/{target_index}")])])]),_._v(" "),t("blockquote",[t("p",[_._v("减少或增加索引的分片数。")])]),_._v(" "),t("p",[_._v("其他操作：")]),_._v(" "),t("ul",[t("li",[t("p",[_._v("复制 "),t("code",[_._v("POST /{index}/_clone/{target_index}")])])]),_._v(" "),t("li",[t("p",[_._v("翻转 "),t("code",[_._v("POST /{rollover-target}/_rollover 或 /{rollover-target}/_rollover/{target-index}")])])]),_._v(" "),t("li",[t("p",[_._v("解析 "),t("code",[_._v("GET /_resolve/index/{name}")])])])])])}),[],!1,null,null,null);t.default=s.exports}}]);